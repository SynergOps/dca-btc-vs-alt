//@version=6
strategy("DCA performance by Cerebrux", overlay=true, pyramiding = 10000, default_qty_type=strategy.percent_of_equity, default_qty_value=100, calc_on_every_tick=true, process_orders_on_close=true)

// === Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î§ÏÎ®ÏƒÏ„Î· ===
investmentAmount = input.float(100, "Î Î¿ÏƒÏŒ Î•Ï€Î­Î½Î´Ï…ÏƒÎ·Ï‚ (â‚¬)", minval=1)
dcaInterval = input.string("ÎœÎ·Î½Î¹Î±Î¯Î±", "Î£Ï…Ï‡Î½ÏŒÏ„Î·Ï„Î± Î•Ï€Î­Î½Î´Ï…ÏƒÎ·Ï‚", options=["Î—Î¼ÎµÏÎ®ÏƒÎ¹Î±", "Î•Î²Î´Î¿Î¼Î±Î´Î¹Î±Î¯Î±", "ÎœÎ·Î½Î¹Î±Î¯Î±"])
startDate = input.time(timestamp("2020-04-01 00:00 +0000"), "Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± ÎˆÎ½Î±ÏÎ¾Î·Ï‚")
endDate = input.time(timestamp("2999-04-01 00:00 +0000"), "Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î›Î®Î¾Î·Ï‚")
tradingFeePercent = input.float(0.1, "Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ Î¤Î­Î»Î¿Ï…Ï‚ Î£Ï…Î½Î±Î»Î»Î±Î³ÏÎ½ (%)", minval=0, tooltip="Î•Î¹ÏƒÎ¬Î³ÎµÏ„Îµ Ï„Î¿ Ï€Î¿ÏƒÎ¿ÏƒÏ„ÏŒ Ï„Î­Î»Î¿Ï…Ï‚ ÏƒÏ…Î½Î±Î»Î»Î±Î³ÏÎ½, Ï€.Ï‡. 0.1 Î³Î¹Î± Ï„Î¿ Binance Maker Fee")

// === Investment Logic ===
var float totalInvested = 0
var float totalUnits = 0    
var float maxEquity = 0
var float maxDrawdown = 0
var float drawdownStartPrice = na
var float[] dailyReturns = array.new_float()
var float initialPrice = na
//var float buyAndHoldUnits = 0
//var float buyAndHoldFees = 0
var float totalInvestmentAmount = 0
var float totalFeesPaid = 0
// Calculate total investment periods and amount
var int totalPeriods = 0
// === Performance Metrics ===
var float[] monthlyReturns = array.new_float()
var float previousMonthClose = na
// Detect start of a new month
isNewMonth = month != month[1]

// Store previous month's close
if isNewMonth
    if not na(previousMonthClose) and not na(close)
        monthlyReturn = (close - previousMonthClose) / previousMonthClose
        array.push(monthlyReturns, monthlyReturn)
    previousMonthClose := close

// Monthly risk-free rate (~2% annual e.g. Gov Bonds)
monthlyRiskFreeRate = 0.02 / 12

isInvestmentTime = switch dcaInterval
    "Î—Î¼ÎµÏÎ®ÏƒÎ¹Î±" => dayofmonth != dayofmonth[1]
    "Î•Î²Î´Î¿Î¼Î±Î´Î¹Î±Î¯Î±" => dayofweek == dayofweek.monday and dayofweek != dayofweek[1]
    "ÎœÎ·Î½Î¹Î±Î¯Î±" => month != month[1]
    => false

if time >= startDate and time <= endDate
    // For daily, each period is 1 day (86400000 milliseconds)
    if dcaInterval == "Î—Î¼ÎµÏÎ®ÏƒÎ¹Î±"
        totalPeriods := math.floor((endDate - startDate) / (24 * 60 * 60 * 1000))
    // For weekly, each period is 7 days (604800000 milliseconds)
    else if dcaInterval == "Î•Î²Î´Î¿Î¼Î±Î´Î¹Î±Î¯Î±"
        totalPeriods := math.floor((endDate - startDate) / (7 * 24 * 60 * 60 * 1000))
    // For monthly, each period is 30 days (2592000000 milliseconds)
    else if dcaInterval == "ÎœÎ·Î½Î¹Î±Î¯Î±"
        totalPeriods := math.floor((endDate - startDate) / (30 * 24 * 60 * 60 * 1000))

canInvest = time >= startDate and time <= endDate and isInvestmentTime

if canInvest
    if isInvestmentTime
        totalInvested += investmentAmount
        fee = investmentAmount * (tradingFeePercent / 100)
        totalFeesPaid += fee
        netInvestment = investmentAmount - fee
        unitsBought = netInvestment / close
        totalUnits += unitsBought
        totalInvestmentAmount += investmentAmount
        totalPeriods += 1
        // Simulate a symbolic strategy entry so Strategy Tester shows trades
        strategy.entry("DCA Buy", strategy.long, qty=investmentAmount / close)
        if na(initialPrice)
            initialPrice := close
    else 
        if time == endDate
            strategy.close_all()
totalInvestmentAmount := investmentAmount * totalPeriods

// === Calculations ===
currentValue = totalUnits * close
profit = currentValue - totalInvested
roi = totalInvested > 0 ? (profit / totalInvested) * 100 : na

// Calculate drawdown
drawdown = maxEquity > 0 ? (currentValue - maxEquity) / maxEquity * 100 : 0
if currentValue > maxEquity
    maxEquity := currentValue
else if drawdown < maxDrawdown
    maxDrawdown := drawdown
    drawdownStartPrice := close
    //label.new(bar_index, high, "ÎœÎ­Î³Î¹ÏƒÏ„Î· Î Ï„ÏÏƒÎ· âš‘", style=label.style_label_down, color=color.red, textcolor=color.white, size=size.tiny)

// === Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼ÏŒÎ½Î¿ Ï„Î¿Ï… Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿Ï… Î¼Î­Î³Î¹ÏƒÏ„Î¿Ï… Drawdown ===
var label lastMaxDrawdownLabel = na  // Î‘Ï€Î¿Î¸Î·ÎºÎµÏÎµÎ¹ Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± ÎµÏ„Î¹ÎºÎ­Ï„Î±

if ta.change(maxDrawdown) != 0
    // Î”Î¹Î±Î³ÏÎ±Ï†Î® Ï„Î·Ï‚ Ï€ÏÎ¿Î·Î³Î¿ÏÎ¼ÎµÎ½Î·Ï‚ ÎµÏ„Î¹ÎºÎ­Ï„Î±Ï‚ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹
    if not na(lastMaxDrawdownLabel)
        label.delete(lastMaxDrawdownLabel)
    // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î½Î­Î±Ï‚ ÎµÏ„Î¹ÎºÎ­Ï„Î±Ï‚ Î³Î¹Î± Ï„Î¿ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î¿ Î¼Î­Î³Î¹ÏƒÏ„Î¿ Drawdown
    lastMaxDrawdownLabel := label.new(bar_index, low, "ÎœÎ­Î³Î¹ÏƒÏ„Î· Î Ï„ÏÏƒÎ·: " + str.tostring(maxDrawdown, "#.##") + "%", style=label.style_label_up, color=color.red, textcolor=color.white, size=size.normal)

// Calculate average cost basis
avgCostBasis = totalUnits > 0 ? totalInvested / totalUnits : na
plot(avgCostBasis, "ÎœÎ­ÏƒÎ¿ ÎšÏŒÏƒÏ„Î¿Ï‚ ÎšÏ„Î®ÏƒÎ·Ï‚", color=color.purple, style=plot.style_circles, linewidth=2)

// ÎŸ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe ÎµÎ¯Î½Î±Î¹ Î­Î½Î± Î¼Î­Ï„ÏÎ¿ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿. Î Î¿ÏƒÎ¿Ï„Î¹ÎºÎ¿Ï€Î¿Î¹ÎµÎ¯ Ï€ÏŒÏƒÎ· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± ÎµÏ€Î­Î½Î´Ï…ÏƒÎ· ÏƒÎµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï€Î¿Ï… Î±Î½Î±Î»Î±Î¼Î²Î¬Î½ÎµÎ¹.
// ÎŒÏ„Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î· ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® Dollar Cost Averaging (DCA), Î¿ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ ÏƒÏ„Î·Î½ Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· Ï„Î·Ï‚ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î±Ï‚ Î±Ï…Ï„Î®Ï‚ Ï„Î·Ï‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®Ï‚ ÎµÏ€Î­Î½Î´Ï…ÏƒÎ·Ï‚. Î ÏÏ‚:
// Î£ÏÎ³ÎºÏÎ¹ÏƒÎ· Î‘Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ DCA: ÎŸ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ…Î³ÎºÏÎ¯Î½ÎµÏ„Îµ Ï„Î¹Ï‚ Î±Ï€Î¿Î´ÏŒÏƒÎµÎ¹Ï‚ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½ÎµÏ‚ ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿ Î¼Î¹Î±Ï‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®Ï‚ DCA Î¼Îµ Î¬Î»Î»ÎµÏ‚ ÎµÏ€ÎµÎ½Î´Ï…Ï„Î¹ÎºÎ­Ï‚ Ï€ÏÎ¿ÏƒÎµÎ³Î³Î¯ÏƒÎµÎ¹Ï‚, ÏŒÏ€Ï‰Ï‚ Î· ÎµÏ€Î­Î½Î´Ï…ÏƒÎ· ÎµÏ†Î¬Ï€Î±Î¾.
// Î‘Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· ÎœÎµÎ¯Ï‰ÏƒÎ·Ï‚ ÎšÎ¹Î½Î´ÏÎ½Î¿Ï…: Î¤Î¿ DCA ÏƒÏ„Î¿Ï‡ÎµÏÎµÎ¹ ÏƒÏ„Î· Î¼ÎµÎ¯Ï‰ÏƒÎ· Ï„Î¿Ï… ÎºÎ¹Î½Î´ÏÎ½Î¿Ï… ÎµÎ¾Î¿Î¼Î±Î»ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Ï„Î¹Î¼Î® Î±Î³Î¿ÏÎ¬Ï‚ ÎµÎ½ÏŒÏ‚ Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÎ¿Ï ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿Ï… Î¼Îµ Ï„Î·Î½ Ï€Î¬ÏÎ¿Î´Î¿ Ï„Î¿Ï… Ï‡ÏÏŒÎ½Î¿Ï…. ÎŸ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ Î½Î± Ï€Î¿ÏƒÎ¿Ï„Î¹ÎºÎ¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ ÎµÎ¬Î½ Ï„Î¿ DCA Î²ÎµÎ»Ï„Î¹ÏÎ½ÎµÎ¹ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Ï„Î¿ Ï€ÏÎ¿Ï†Î¯Î» Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î¿ ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿.
// Î’ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î£Ï„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®Ï‚ DCA: ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Ï„Î¿Î½ Î”ÎµÎ¯ÎºÏ„Î· Sharpe Î³Î¹Î± Î½Î± Î±Î½Î±Î»ÏÏƒÎµÏ„Îµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ­Ï‚ DCA, ÏŒÏ€Ï‰Ï‚ Î· Î¼ÎµÏ„Î±Î²Î¿Î»Î® Ï„Î·Ï‚ ÏƒÏ…Ï‡Î½ÏŒÏ„Î·Ï„Î±Ï‚ ÎµÏ€ÎµÎ½Î´ÏÏƒÎµÏ‰Î½ (Ï€.Ï‡. ÎµÎ²Î´Î¿Î¼Î±Î´Î¹Î±Î¯Î± Î­Î½Î±Î½Ï„Î¹ Î¼Î·Î½Î¹Î±Î¯Î±Ï‚), Î³Î¹Î± Î½Î± Î´ÎµÎ¯Ï„Îµ Ï€Î¿Î¹Î± Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Ï„Î·Î½ ÎºÎ±Î»ÏÏ„ÎµÏÎ· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿.

// Î¤Î¹ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î»ÏŒÏ‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe Î³Î¹Î± Î¼Î¹Î± ÎœÎ·Î½Î¹Î±Î¯Î± Î£Ï„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® DCA;
// Î— ÎµÏÎ¼Î·Î½ÎµÎ¯Î± ÎµÎ½ÏŒÏ‚ "ÎºÎ±Î»Î¿Ï" Î”ÎµÎ¯ÎºÏ„Î· Sharpe Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î¹Î±Ï†Î­ÏÎµÎ¹ Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î·Î½ ÎµÏ€Î­Î½Î´Ï…ÏƒÎ· ÎºÎ±Î¹ Ï„Î¹Ï‚ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚ Ï„Î·Ï‚ Î±Î³Î¿ÏÎ¬Ï‚. Î©ÏƒÏ„ÏŒÏƒÎ¿, ÎµÎ´Ï ÎµÎ¯Î½Î±Î¹ Î¼ÎµÏÎ¹ÎºÎ­Ï‚ Î³ÎµÎ½Î¹ÎºÎ­Ï‚ ÎºÎ±Ï„ÎµÏ…Î¸Ï…Î½Ï„Î®ÏÎ¹ÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚:
// ÎšÎ¬Ï„Ï‰ Î±Ï€ÏŒ 1: Î¥Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Î· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï„Î·Ï‚ ÎµÏ€Î­Î½Î´Ï…ÏƒÎ·Ï‚ Î´ÎµÎ½ Î±Î½Ï„Î¹ÏƒÏ„Î±Î¸Î¼Î¯Î¶ÎµÎ¹ ÎµÏ€Î±ÏÎºÏÏ‚ Ï„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿. ÎŒÏƒÎ¿ Ï‡Î±Î¼Î·Î»ÏŒÏ„ÎµÏÎ¿Ï‚ Î¿ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe, Ï„ÏŒÏƒÎ¿ Î»Î¹Î³ÏŒÏ„ÎµÏÎ¿ ÎµÎ»ÎºÏ…ÏƒÏ„Î¹ÎºÎ® ÎµÎ¯Î½Î±Î¹ Î· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿.
// 1 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe 1 Î® Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ Î³ÎµÎ½Î¹ÎºÎ¬ Î±Ï€Î¿Î´ÎµÎºÏ„ÏŒÏ‚. Î¥Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï„Î·Ï‚ ÎµÏ€Î­Î½Î´Ï…ÏƒÎ·Ï‚ Î±Î½Ï„Î¹ÏƒÏ„Î±Î¸Î¼Î¯Î¶ÎµÎ¹ ÎµÏ€Î±ÏÎºÏÏ‚ Ï„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï€Î¿Ï… Î±Î½Î±Î»Î±Î¼Î²Î¬Î½ÎµÏ„Î±Î¹.
// 2 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe 2 Î® Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î»ÏŒÏ‚.
// 3 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe 3 Î® Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÏŒÏ‚.
// Î•Î¯Î½Î±Î¹ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ Î½Î± ÏƒÏ…Î³ÎºÏÎ¯Î½ÎµÏ„Îµ Ï„Î¿Î½ Î”ÎµÎ¯ÎºÏ„Î· Sharpe Ï„Î·Ï‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®Ï‚ DCA ÏƒÎ±Ï‚ Î¼Îµ Î±Ï…Ï„ÏŒÎ½ ÏƒÏ‡ÎµÏ„Î¹ÎºÏÎ½ Î´ÎµÎ¹ÎºÏ„ÏÎ½ Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚, ÏŒÏ€Ï‰Ï‚ Î­Î½Î±Ï‚ ÎµÏ…ÏÏÏ‚ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ Î±Î³Î¿ÏÎ¬Ï‚ Î® Î­Î½Î± Ï‡Î±ÏÏ„Î¿Ï†Ï…Î»Î¬ÎºÎ¹Î¿ Î¼Îµ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î± Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÎ¬ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±. Î›Î¬Î²ÎµÏ„Îµ Ï…Ï€ÏŒÏˆÎ· ÏŒÏ„Î¹ Î­Î½Î±Ï‚ ÎºÎ±Î»ÏŒÏ‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe Î´ÎµÎ½ ÎµÎ³Î³Ï…Î¬Ï„Î±Î¹ Î¼ÎµÎ»Î»Î¿Î½Ï„Î¹ÎºÎ® Î±Ï€ÏŒÎ´Î¿ÏƒÎ· ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ Î½Î± ÎµÎ¾ÎµÏ„Î¬ÏƒÎµÏ„Îµ ÎºÎ±Î¹ Î¬Î»Î»Î¿Ï…Ï‚ Ï€Î±ÏÎ¬Î³Î¿Î½Ï„ÎµÏ‚ Ï€ÏÎ¹Î½ Î»Î¬Î²ÎµÏ„Îµ ÎµÏ€ÎµÎ½Î´Ï…Ï„Î¹ÎºÎ­Ï‚ Î±Ï€Î¿Ï†Î¬ÏƒÎµÎ¹Ï‚.

var float sharpeRatio = na
var float sortinoRatio = na
if array.size(monthlyReturns) > 1
    avgMonthlyReturn = array.avg(monthlyReturns)
    var float[] downsideReturns = array.new_float()
    array.clear(downsideReturns)
    for i = 0 to array.size(monthlyReturns) - 1
        val = array.get(monthlyReturns, i)
        if val < monthlyRiskFreeRate
            array.push(downsideReturns, val)
    downsideDev = array.stdev(downsideReturns)
    sharpeRatio := ((avgMonthlyReturn - monthlyRiskFreeRate) / array.stdev(monthlyReturns)) * math.sqrt(12)
    
    // ÎŒÏ€Ï‰Ï‚ Î¿ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe, Î¿ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino ÎµÏ€Î¹ÎºÎµÎ½Ï„ÏÏÎ½ÎµÏ„Î±Î¹ Î¼ÏŒÎ½Î¿ ÏƒÏ„Î· Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏŒÏ„Î·Ï„Î± Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰ (Î´Î·Î»Î±Î´Î®, Ï„Î·Î½ ÎµÏ€Î¹Î²Î»Î±Î²Î® Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏŒÏ„Î·Ï„Î±). ÎˆÎ½Î±Ï‚ Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino ÎµÎ¯Î½Î±Î¹ Î³ÎµÎ½Î¹ÎºÎ¬ Ï€ÏÎ¿Ï„Î¹Î¼ÏŒÏ„ÎµÏÎ¿Ï‚.
    // Î Î±ÏÎ­Ï‡ÎµÎ¹ Î¼Î¹Î± Ï€Î¹Î¿ Î¾ÎµÎºÎ¬Î¸Î±ÏÎ· ÎµÎ¹ÎºÏŒÎ½Î± Ï„Ï‰Î½ Î±Ï€Î¿Î´ÏŒÏƒÎµÏ‰Î½ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Ï‰Î½ ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿, Î±Î³Î½Î¿ÏÎ½Ï„Î±Ï‚ Ï„Î· "Î¸ÎµÏ„Î¹ÎºÎ®" Î¼ÎµÏ„Î±Î²Î»Î·Ï„ÏŒÏ„Î·Ï„Î± (Î±Î½Î¿Î´Î¹ÎºÎ®).
    // Î•ÏƒÏ„Î¹Î¬Î¶Î¿Î½Ï„Î±Ï‚ ÏƒÏ„Î·Î½ Î±Ï€ÏŒÎºÎ»Î¹ÏƒÎ· Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰, Î¿ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino Ï€Î±ÏÎ­Ï‡ÎµÎ¹ Î­Î½Î± Ï€Î¹Î¿ ÎµÎºÎ»ÎµÏ€Ï„Ï…ÏƒÎ¼Î­Î½Î¿ Î¼Î­Ï„ÏÎ¿ ÎºÎ¹Î½Î´ÏÎ½Î¿Ï…, Î¹Î´Î¹Î±Î¯Ï„ÎµÏÎ± Î³Î¹Î± ÎµÏ€ÎµÎ½Î´ÏÏƒÎµÎ¹Ï‚ Î¼Îµ Î±ÏƒÏÎ¼Î¼ÎµÏ„ÏÎµÏ‚ ÎºÎ±Ï„Î±Î½Î¿Î¼Î­Ï‚ Î±Ï€Î¿Î´ÏŒÏƒÎµÏ‰Î½.
    // ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ 1.0 Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ Î³ÎµÎ½Î¹ÎºÎ¬ ÎºÎ±ÎºÏŒÏ‚. Î‘Ï…Ï„ÏŒ Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÏŒÏ„Î¹ Î· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï„Î·Ï‚ ÎµÏ€Î­Î½Î´Ï…ÏƒÎ·Ï‚ Î´ÎµÎ½ Î±Î½Ï„Î¹ÏƒÏ„Î±Î¸Î¼Î¯Î¶ÎµÎ¹ ÎµÏ€Î±ÏÎºÏÏ‚ Ï„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰. ÎœÎµ Î¬Î»Î»Î± Î»ÏŒÎ³Î¹Î±, Î±Î½Î±Î»Î±Î¼Î²Î¬Î½ÎµÏ„Îµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰ Î³Î¹Î± Ï„Î·Î½ Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï€Î¿Ï… Î´Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯Ï„Îµ.
    // 1.5 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino 1.5 Î® Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ Î³ÎµÎ½Î¹ÎºÎ¬ Î±Ï€Î¿Î´ÎµÎºÏ„ÏŒÏ‚.
    // 2 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino 2 Î® Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î»ÏŒÏ‚.
    // 2.5 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino 2.5 Î® Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÏŒÏ‚.
    sortinoRatio := downsideDev != 0 ? ((avgMonthlyReturn - monthlyRiskFreeRate) / downsideDev) * math.sqrt(12) : na

// Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ CAGR (Î£ÏÎ½Î¸ÎµÏ„Î¿Ï‚ Î•Ï„Î®ÏƒÎ¹Î¿Ï‚ Î¡Ï…Î¸Î¼ÏŒÏ‚ Î‘Î½Î¬Ï€Ï„Ï…Î¾Î·Ï‚)
// ÎŸ Î¼Î­ÏƒÎ¿Ï‚ ÎµÏ„Î®ÏƒÎ¹Î¿Ï‚ ÏÏ…Î¸Î¼ÏŒÏ‚ Î±Î½Î¬Ï€Ï„Ï…Î¾Î·Ï‚ Ï„Î·Ï‚ ÎµÏ€Î­Î½Î´Ï…ÏƒÎ®Ï‚ ÏƒÎ±Ï‚, Î±Î½ ÎµÎ¯Ï‡Îµ Î±Ï…Î¾Î·Î¸ÎµÎ¯ Î¼Îµ ÏƒÏ„Î±Î¸ÎµÏÏŒ ÏÏ…Î¸Î¼ÏŒ.
// Î£Î±Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€ÏŒÏƒÎ¿ Î³ÏÎ®Î³Î¿ÏÎ± Î±Ï…Î¾Î¬Î½ÎµÏ„Î±Î¹ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÎ¬ Î· ÎµÏ€Î­Î½Î´Ï…ÏƒÎ® ÏƒÎ±Ï‚ Î¼Îµ Ï„Î·Î½ Ï€Î¬ÏÎ¿Î´Î¿ Ï„Î¿Ï… Ï‡ÏÏŒÎ½Î¿Ï….
// Î•Î¯Î½Î±Î¹ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ Î³Î¹Î± Ï„Î· ÏƒÏÎ³ÎºÏÎ¹ÏƒÎ· ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÏÎ½ ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Ï‡ÏÎ¿Î½Î¹ÎºÎ­Ï‚ Ï€ÎµÏÎ¹ÏŒÎ´Î¿Ï…Ï‚ Î® Î¼Îµ ÎºÎ¬Ï„Î¹ ÏŒÏ€Ï‰Ï‚ Î­Î½Î± Î±Î¼Î¿Î¹Î²Î±Î¯Î¿ ÎºÎµÏ†Î¬Î»Î±Î¹Î¿ Î´ÎµÎ¯ÎºÏ„Î·.
// Î•Î´Ï ÎµÎ¯Î½Î±Î¹ Î¼ÎµÏÎ¹ÎºÎ¬ Î³ÎµÎ½Î¹ÎºÎ¬ ÏƒÎ·Î¼ÎµÎ¯Î± Î±Î½Î±Ï†Î¿ÏÎ¬Ï‚:
// 1. ÎœÎµÏ„Î¿Ï‡Î­Ï‚: Î™ÏƒÏ„Î¿ÏÎ¹ÎºÎ¬, Î· Î¼Î­ÏƒÎ· ÎµÏ„Î®ÏƒÎ¹Î± Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï„Î·Ï‚ Ï‡ÏÎ·Î¼Î±Ï„Î¹ÏƒÏ„Î·ÏÎ¹Î±ÎºÎ®Ï‚ Î±Î³Î¿ÏÎ¬Ï‚ Ï„Ï‰Î½ Î—.Î .Î‘. Î®Ï„Î±Î½ Ï€ÎµÏÎ¯Ï€Î¿Ï… 10%. Î•Ï€Î¿Î¼Î­Î½Ï‰Ï‚, Î­Î½Î± CAGR ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ¬ Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿ Î±Ï€ÏŒ 10% Î¸Î± Î¸ÎµÏ‰ÏÎ¿ÏÎ½Ï„Î±Î½ Ï€Î¿Î»Ï ÎºÎ±Î»ÏŒ Î³Î¹Î± Î¼Î¹Î± ÎµÏ€Î­Î½Î´Ï…ÏƒÎ· ÏƒÎµ Î¼ÎµÏ„Î¿Ï‡Î­Ï‚.
// 2. Î‘ÎºÎ¯Î½Î·Ï„Î±: ÎœÎ±ÎºÏÎ¿Ï€ÏÏŒÎ¸ÎµÏƒÎ¼Î±, Î· Î¼Î­ÏƒÎ· ÎµÏ„Î®ÏƒÎ¹Î± Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Î³Î¹Î± Ï„Î± Î±ÎºÎ¯Î½Î·Ï„Î± Î®Ï„Î±Î½ ÏƒÎµ Î¼Î¿Î½Î¿ÏˆÎ®Ï†Î¹Î± Ï€Î¿ÏƒÎ¿ÏƒÏ„Î¬, ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ Ï„Î¹Ï‚ Î±Ï€Î¿Î´ÏŒÏƒÎµÎ¹Ï‚ Ï„Î·Ï‚ Ï‡ÏÎ·Î¼Î±Ï„Î¹ÏƒÏ„Î·ÏÎ¹Î±ÎºÎ®Ï‚ Î±Î³Î¿ÏÎ¬Ï‚. ÎˆÎ½Î± "ÎºÎ±Î»ÏŒ" CAGR Î¸Î± Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÏƒÏ…Î³ÎºÏÎ¹Î¸ÎµÎ¯ Î¼Îµ Ï„Î¹Ï‚ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ ÏƒÏ…Î½Î¸Î®ÎºÎµÏ‚ Ï„Î·Ï‚ Î±Î³Î¿ÏÎ¬Ï‚ ÎºÎ±Î¹ Ï„Î¿Ï…Ï‚ Ï„ÏÏ€Î¿Ï…Ï‚ Î±ÎºÎ¹Î½Î®Ï„Ï‰Î½.
// 3. Î“Î¹Î± Î¼Î¹Î± ÎœÎ·Î½Î¹Î±Î¯Î± Î£Ï„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® DCA: ÎˆÎ½Î± ÎºÎ±Î»ÏŒ CAGR Î³Î¹Î± Î¼Î¹Î± Î¼Î·Î½Î¹Î±Î¯Î± ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® DCA Î¸Î± ÎµÎ¾Î±ÏÏ„Î·Î¸ÎµÎ¯ Î±Ï€ÏŒ Ï„Î·Î½ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÏÎ½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÏ„Î·Î½ Î¿Ï€Î¿Î¯Î± ÎµÏ€ÎµÎ½Î´ÏÎµÏ„Îµ. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î±Î½ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Îµ Ï„Î¿ DCA Î³Î¹Î± Î½Î± ÎµÏ€ÎµÎ½Î´ÏÏƒÎµÏ„Îµ ÏƒÏ„Î· Ï‡ÏÎ·Î¼Î±Ï„Î¹ÏƒÏ„Î·ÏÎ¹Î±ÎºÎ® Î±Î³Î¿ÏÎ¬, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÏ„Î¿Ï‡ÎµÏÎµÏ„Îµ ÏƒÎµ Î­Î½Î± CAGR ÏƒÏ„Î·Î½ Ï€ÎµÏÎ¹Î¿Ï‡Î® Ï„Î¿Ï… 7-10% Î® Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿. Î‘Î½ ÎµÏ€ÎµÎ½Î´ÏÎµÏ„Îµ ÏƒÎµ Î¼Î¹Î± Ï€Î¹Î¿ Î±ÏƒÏ„Î±Î¸Î® ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÏÎ½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½, ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Bitcoin, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÏ„Îµ Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿ CAGR, Î±Î»Î»Î¬ Î¼Îµ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ ÎºÎ¯Î½Î´Ï…Î½Î¿.
numYears = (endDate - startDate) / (365 * 24 * 60 * 60 * 1000)
cagr = (totalInvested > 0 and numYears > 0) ? math.pow(currentValue / totalInvested, 1 / numYears) - 1 : na

// Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Calmar
// Î£Ï…Î³ÎºÏÎ¯Î½ÎµÎ¹ Ï„Î·Î½ ÎµÏ„Î·ÏƒÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Î¼Î¹Î±Ï‚ ÎµÏ€Î­Î½Î´Ï…ÏƒÎ·Ï‚ Î¼Îµ Ï„Î· Î¼Î­Î³Î¹ÏƒÏ„Î· Ï€Ï„ÏÏƒÎ· Ï„Î·Ï‚.
// ÎˆÎ½Î±Ï‚ Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Calmar Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÎºÎ±Î»ÏÏ„ÎµÏÎ· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿, Î¼Îµ Î­Î¼Ï†Î±ÏƒÎ· ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰. Î”ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€ÏŒÏƒÎ· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Î­Ï‡ÎµÎ¹ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÎµÎ¹ Î¼Î¹Î± ÎµÏ€Î­Î½Î´Ï…ÏƒÎ· ÏƒÎµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î· Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î±Ï€ÏÎ»ÎµÎ¹Î¬ Ï„Î·Ï‚.
// 1 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Calmar 1 Î® Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ Î³ÎµÎ½Î¹ÎºÎ¬ Î±Ï€Î¿Î´ÎµÎºÏ„ÏŒÏ‚. Î¥Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î· ÎµÏ„Î·ÏƒÎ¹Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï„Î·Ï‚ ÎµÏ€Î­Î½Î´Ï…ÏƒÎ·Ï‚ ÎµÎ¯Î½Î±Î¹ Î¯ÏƒÎ· Î® Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î±Ï€ÏŒ Ï„Î· Î¼Î­Î³Î¹ÏƒÏ„Î· Ï€Ï„ÏÏƒÎ· Ï„Î·Ï‚.
// 2 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Calmar 2 Î® Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î»ÏŒÏ‚.
// 3 Î® Î¥ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚: ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Calmar 3 Î® Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÏŒÏ‚.
calmarRatio = maxDrawdown != 0 ? cagr / math.abs(maxDrawdown / 100) : na

// Predefined colors
color_white = color.new(color.white, 0)
color_navy = color.new(color.navy, 0)
color_gray = color.new(color.gray, 0)
color_dark_gray = color.new(color.gray, 90) // A darker shade of gray for comments

// === Optional Settings for Displaying Ratios ===
showSharpeRatio = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Sharpe Ratio", tooltip="ÎŸ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe Î¼ÎµÏ„ÏÎ¬ Ï„Î·Î½ Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï„Î·Ï‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®Ï‚. ÎˆÎ½Î±Ï‚ Î´ÎµÎ¯ÎºÏ„Î·Ï‚ >1.0 Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ ÎºÎ±Î»ÏÏ„ÎµÏÎ· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î· ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿.")
showSortinoRatio = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Sortino Ratio", tooltip="ÎŸ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Ï€Î±ÏÎ±Î»Î»Î±Î³Î® Ï„Î¿Ï… Î”ÎµÎ¯ÎºÏ„Î· Sharpe Ï€Î¿Ï… Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï…Ï€ÏŒÏˆÎ· Î¼ÏŒÎ½Î¿ Ï„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï€ÏÎ¿Ï‚ Ï„Î± ÎºÎ¬Ï„Ï‰, ÎºÎ±Î¸Î¹ÏƒÏ„ÏÎ½Ï„Î±Ï‚ Ï„Î¿Î½ Ï€Î¹Î¿ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î¿ Î³Î¹Î± ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ­Ï‚ Î¼Îµ Î±ÏÎ½Î·Ï„Î¹ÎºÎ® Î±ÏƒÏ…Î¼Î¼ÎµÏ„ÏÎ¯Î±. ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ 1.0 Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎºÎ±ÎºÏŒÏ‚, ÎµÎ½Ï 1.5 Î® Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Ï€Î¿Î´ÎµÎºÏ„ÏŒÏ‚.")
showCAGR = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· CAGR", tooltip="ÎŸ Î£ÏÎ½Î¸ÎµÏ„Î¿Ï‚ Î•Ï„Î®ÏƒÎ¹Î¿Ï‚ Î¡Ï…Î¸Î¼ÏŒÏ‚ Î‘Î½Î¬Ï€Ï„Ï…Î¾Î·Ï‚ (CAGR) ÎµÎ¯Î½Î±Î¹ Î¿ ÏÏ…Î¸Î¼ÏŒÏ‚ Î¼Îµ Ï„Î¿Î½ Î¿Ï€Î¿Î¯Î¿ Î¼Î¹Î± ÎµÏ€Î­Î½Î´Ï…ÏƒÎ· Î¸Î± ÎµÎ¯Ï‡Îµ Î±Ï…Î¾Î·Î¸ÎµÎ¯ Î±Î½ ÎµÎ¯Ï‡Îµ Î±Ï…Î¾Î·Î¸ÎµÎ¯ Î¼Îµ ÏƒÏ„Î±Î¸ÎµÏÏŒ ÏÏ…Î¸Î¼ÏŒ, ÎµÏ„Î·ÏƒÎ¯Ï‰Ï‚. ÎˆÎ½Î±Ï‚ CAGR 7-10% Î® Ï…ÏˆÎ·Î»ÏŒÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ ÎºÎ±Î»ÏŒÏ‚ Î³Î¹Î± Î¼Î¹Î± ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ® DCA.")
showCalmarRatio = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Calmar Ratio", tooltip="ÎŸ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Calmar ÎµÎ¯Î½Î±Î¹ Î¿ Î»ÏŒÎ³Î¿Ï‚ Ï„Î·Ï‚ Î¼Î­ÏƒÎ·Ï‚ ÎµÏ„Î®ÏƒÎ¹Î±Ï‚ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ Ï€ÏÎ¿Ï‚ Ï„Î· Î¼Î­Î³Î¹ÏƒÏ„Î· Ï€Ï„ÏÏƒÎ·, Î²Î¿Î·Î¸ÏÎ½Ï„Î±Ï‚ ÏƒÏ„Î·Î½ Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· Ï„Î·Ï‚ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÎ¼Î­Î½Î·Ï‚ ÏƒÏ„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿ ÏƒÎµ Î±ÏƒÏ„Î±Î¸ÎµÎ¯Ï‚ Î±Î³Î¿ÏÎ­Ï‚. ÎˆÎ½Î±Ï‚ Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Calmar 1 Î® Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿Ï‚ Î¸ÎµÏ‰ÏÎµÎ¯Ï„Î±Î¹ Î±Ï€Î¿Î´ÎµÎºÏ„ÏŒÏ‚, ÎµÎ½Ï ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ 1 Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î· Î±Ï€ÏŒÎ´Î¿ÏƒÎ· Î´ÎµÎ½ Î±Î½Ï„Î¹ÏƒÏ„Î±Î¸Î¼Î¯Î¶ÎµÎ¹ ÎµÏ€Î±ÏÎºÏÏ‚ Ï„Î¿Î½ ÎºÎ¯Î½Î´Ï…Î½Î¿.")
showAvgCostBasis = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Avg Cost Basis", tooltip="Î¤Î¿ ÎœÎ­ÏƒÎ¿ ÎšÏŒÏƒÏ„Î¿Ï‚ ÎšÏ„Î®ÏƒÎ·Ï‚ Î±Î½Ï„Î¹Ï€ÏÎ¿ÏƒÏ‰Ï€ÎµÏÎµÎ¹ Ï„Î· Î¼Î­ÏƒÎ· Ï„Î¹Î¼Î® ÏƒÏ„Î·Î½ Î¿Ï€Î¿Î¯Î± Î­Ï‡ÎµÎ¹ Î±Î³Î¿ÏÎ±ÏƒÏ„ÎµÎ¯ Ï„Î¿ Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÏŒ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½ Ï„Ï‰Î½ ÎµÎ¾ÏŒÎ´Ï‰Î½ ÏƒÏ…Î½Î±Î»Î»Î±Î³ÏÎ½.")

// === Optional Settings for Displaying Metrics ===
showTotalInvested = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Total Invested", tooltip="Î¤Î¿ Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ Î•Ï€ÎµÎ½Î´Ï…Î¼Î­Î½Î¿ Ï€Î¿ÏƒÏŒ Î±Î½Ï„Î¹Ï€ÏÎ¿ÏƒÏ‰Ï€ÎµÏÎµÎ¹ Ï„Î¿ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏŒ Ï€Î¿ÏƒÏŒ Ï‡ÏÎ·Î¼Î¬Ï„Ï‰Î½ Ï€Î¿Ï… ÎµÏ€ÎµÎ½Î´ÏÎ¸Î·ÎºÎ±Î½ ÏƒÏ„Î· ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½ ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î±Î³Î¿ÏÏÎ½ Ï€Î¿Ï… Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎ±Î½ Î¼Îµ Ï„Î·Î½ Ï€Î¬ÏÎ¿Î´Î¿ Ï„Î¿Ï… Ï‡ÏÏŒÎ½Î¿Ï….")
showFeesPaid = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Fees Paid", tooltip="Î¤Î± Î Î»Î·ÏÏ‰Î¼Î­Î½Î± Î¤Î­Î»Î· Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ Ï„Î¿ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏŒ ÎºÏŒÏƒÏ„Î¿Ï‚ Î±Ï€ÏŒ Ï„Î·Î½ Î±Î³Î¿ÏÎ¬ Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÏÎ½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½, ÏŒÏ€Ï‰Ï‚ Ï„Î­Î»Î· Î±Î½Ï„Î±Î»Î»Î±Î³Î®Ï‚ Î® Î­Î¾Î¿Î´Î± ÏƒÏ…Î½Î±Î»Î»Î±Î³ÏÎ½.")
showNetCostPerUnit = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Net Cost / Units", tooltip="Î¤Î¿ ÎšÎ±Î¸Î±ÏÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î±Î½Î¬ ÎœÎ¿Î½Î¬Î´Î± Î±Î½Ï„Î¹Ï€ÏÎ¿ÏƒÏ‰Ï€ÎµÏÎµÎ¹ Ï„Î·Î½ Ï„Î¹Î¼Î® Î±Î½Î¬ Î¼Î¿Î½Î¬Î´Î± Ï„Î¿Ï… Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÎ¿Ï ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿Ï… Î¼ÎµÏ„Î¬ Ï„Î·Î½ Î±Ï†Î±Î¯ÏÎµÏƒÎ· Ï„Ï‰Î½ ÎµÎ¾ÏŒÎ´Ï‰Î½.")
showTotalUnits = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Total Units", tooltip="ÎŸÎ¹ Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎœÎ¿Î½Î¬Î´ÎµÏ‚ Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î½ Ï„Î¿Î½ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏŒ Î±ÏÎ¹Î¸Î¼ÏŒ Î½Î¿Î¼Î¹ÏƒÎ¼Î¬Ï„Ï‰Î½ Î® Î¼Î¿Î½Î¬Î´Ï‰Î½ Ï„Î¿Ï… Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÎ¿Ï ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿Ï… Ï€Î¿Ï… Î±Ï€Î¿ÎºÏ„Î®Î¸Î·ÎºÎ±Î½ Î¼Î­ÏƒÏ‰ Ï„Î·Ï‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®Ï‚.")
showCurrentValue = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Current Value", tooltip="Î— Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Ï„Î·Î½ Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î±Î¾Î¯Î± Ï„Ï‰Î½ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏÎ½ Î¼Î¿Î½Î¬Î´Ï‰Î½ Ï€Î¿Ï… ÎºÎ±Ï„Î­Ï‡Î¿Î½Ï„Î±Î¹, Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± Ï„Î¹Î¼Î® Ï„Î¿Ï… Ï€ÎµÏÎ¹Î¿Ï…ÏƒÎ¹Î±ÎºÎ¿Ï ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î¿Ï….")
showProfit = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Profit", tooltip="Î¤Î¿ ÎšÎ­ÏÎ´Î¿Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï„Î· Î´Î¹Î±Ï†Î¿ÏÎ¬ Î¼ÎµÏ„Î±Î¾Ï Ï„Î·Ï‚ ÏƒÏ…Î½Î¿Î»Î¹ÎºÎ®Ï‚ Ï„ÏÎ­Ï‡Î¿Ï…ÏƒÎ±Ï‚ Î±Î¾Î¯Î±Ï‚ ÎºÎ±Î¹ Ï„Î¿Ï… ÏƒÏ…Î½Î¿Î»Î¹ÎºÎ¿Ï ÎµÏ€ÎµÎ½Î´Ï…Î¼Î­Î½Î¿Ï… Ï€Î¿ÏƒÎ¿Ï, Î±Î½Ï„Î¹Ï€ÏÎ¿ÏƒÏ‰Ï€ÎµÏÎ¿Î½Ï„Î±Ï‚ Ï„Î¿ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏŒ ÎºÎ­ÏÎ´Î¿Ï‚ Î® Î¶Î·Î¼Î¯Î± Ï„Î·Ï‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®Ï‚.")
showROI = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ROI", tooltip="Î— Î‘Ï€ÏŒÎ´Î¿ÏƒÎ· Î•Ï€Î­Î½Î´Ï…ÏƒÎ·Ï‚ (ROI) ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€Î¿ÏƒÎ¿ÏƒÏ„ÏŒ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ ÏƒÏ„Î¿ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏŒ ÎµÏ€ÎµÎ½Î´Ï…Î¼Î­Î½Î¿ Ï€Î¿ÏƒÏŒ, Ï€Î¿Ï… Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ Ï€ÏŒÏƒÎ¿ ÎºÎ­ÏÎ´Î¿Ï‚ Î® Î¶Î·Î¼Î¯Î± Î­Ï‡ÎµÎ¹ ÎµÏ€Î¹Ï„ÎµÏ…Ï‡Î¸ÎµÎ¯ ÏƒÎµ ÏƒÏ‡Î­ÏƒÎ· Î¼Îµ Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® ÎµÏ€Î­Î½Î´Ï…ÏƒÎ·.")
showMaxDrawdown = input.bool(true, title="Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Max Drawdown", tooltip="Î— ÎœÎ­Î³Î¹ÏƒÏ„Î· Î Ï„ÏÏƒÎ· Î¼ÎµÏ„ÏÎ¬ Ï„Î· Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î¼ÎµÎ¯Ï‰ÏƒÎ· Î±Ï€ÏŒ Ï„Î·Î½ ÎºÎ¿ÏÏ…Ï†Î® ÏƒÏ„Î·Î½ ÎºÎ±Ï„ÏÏ„Î±Ï„Î· Ï„Î¹Î¼Î® ÎºÎ±Ï„Î¬ Ï„Î· Î´Î¹Î¬ÏÎºÎµÎ¹Î± Ï„Î·Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚ Ï„Î·Ï‚ ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®Ï‚, Î´ÎµÎ¯Ï‡Î½Î¿Î½Ï„Î±Ï‚ Ï„Î¿Î½ Î¼Î­Î³Î¹ÏƒÏ„Î¿ ÎºÎ¯Î½Î´Ï…Î½Î¿ Ï€Î¿Ï… Î±Î½Î±Î»Î®Ï†Î¸Î·ÎºÎµ ÏƒÏ„Î·Î½ Ï‡ÎµÎ¹ÏÏŒÏ„ÎµÏÎ· Ï€ÎµÏÎ¯Î¿Î´Î¿.")

// === TABLE ===
var table statsTable = table.new(position.top_right, 3, 14, border_width=2)

if bar_index % 10 == 0 or na(bar_index)
    // Table Headers
    table.cell(statsTable, 0, 0, "ğŸ“Š Î”ÎµÎ¯ÎºÏ„Î·Ï‚", text_color=color_white, bgcolor=color_navy, text_halign=text.align_center)
    table.cell(statsTable, 1, 0, "Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±", text_color=color_white, bgcolor=color_navy, text_halign=text.align_center)
    
    // Total Invested
    if showTotalInvested
        table.cell(statsTable, 0, 1, "ğŸ’µ Î£Ï…Î½Î¿Î»Î¹ÎºÎ® Î•Ï€Î­Î½Î´Ï…ÏƒÎ·", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 1, str.tostring(totalInvested, format.mintick), text_color=color_white, bgcolor=color_gray)

    // Fees Paid
    if showFeesPaid
        table.cell(statsTable, 0, 2, "ğŸ’¸ Î Î»Î·ÏÏ‰Î¼Î­Î½Î± Î¤Î­Î»Î·", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 2, str.tostring(totalFeesPaid, format.mintick), text_color=color_white, bgcolor=color_gray)

    // Net Cost for Units
    if showNetCostPerUnit
        table.cell(statsTable, 0, 3, "ğŸ’² ÎšÎ±Î¸Î±ÏÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ / ÎœÎ¿Î½Î¬Î´ÎµÏ‚", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 3, str.tostring(totalInvested - totalFeesPaid, format.mintick), text_color=color_white, bgcolor=color_gray)

    // Total Units
    if showTotalUnits
        table.cell(statsTable, 0, 4, "ğŸª™ Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎœÎ¿Î½Î¬Î´ÎµÏ‚", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 4, str.tostring(totalUnits, format.mintick), text_color=color_white, bgcolor=color_gray)

    // Current Value
    if showCurrentValue
        table.cell(statsTable, 0, 5, "ğŸ“ˆ Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î±", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 5, str.tostring(currentValue, format.mintick), text_color=color_white, bgcolor=color_gray)

    // Profit
    if showProfit
        table.cell(statsTable, 0, 6, "ğŸ’° ÎšÎ­ÏÎ´Î¿Ï‚", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 6, str.tostring(profit, format.mintick), text_color=color_white, bgcolor=color_gray)

    // ROI
    if showROI
        table.cell(statsTable, 0, 7, "ğŸ“Š Î‘Ï€ÏŒÎ´Î¿ÏƒÎ· Î•Ï€Î­Î½Î´Ï…ÏƒÎ·Ï‚ (ROI)", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 7, str.tostring(roi, "#.##") + "%", text_color=color_white, bgcolor=color_gray)

    // Max Drawdown
    if showMaxDrawdown
        table.cell(statsTable, 0, 8, "ğŸ“‰ ÎœÎ­Î³Î¹ÏƒÏ„Î· Î Ï„ÏÏƒÎ·", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 8, str.tostring(maxDrawdown, "#.##") + "%", text_color=color_white, bgcolor=color_gray)

    // Only show Sharpe Ratio if enabled
    if showSharpeRatio
        table.cell(statsTable, 0, 9, "ğŸ“Š Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sharpe", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 9, str.tostring(sharpeRatio, "#.##"), text_color=color_white, bgcolor=color_gray)

    // Only show Sortino Ratio if enabled
    if showSortinoRatio
        table.cell(statsTable, 0, 10, "ğŸ“Š Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Sortino", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 10, str.tostring(sortinoRatio, "#.##"), text_color=color_white, bgcolor=color_gray)

    // Only show CAGR if enabled
    if showCAGR
        table.cell(statsTable, 0, 11, "ğŸ“ˆ CAGR", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 11, str.tostring(cagr * 100, "#.##") + "%", text_color=color_white, bgcolor=color_gray)
    
    // Only show Calmar Ratio if enabled
    if showCalmarRatio
        table.cell(statsTable, 0, 12, "ğŸ“Š Î”ÎµÎ¯ÎºÏ„Î·Ï‚ Calmar", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 12, str.tostring(calmarRatio, "#.##"), text_color=color_white, bgcolor=color_gray)

    // Only show Avg Cost Basis if enabled
    if showAvgCostBasis
        table.cell(statsTable, 0, 13, "ğŸ“ˆ ÎœÎ­ÏƒÎ¿ ÎšÏŒÏƒÏ„Î¿Ï‚ ÎšÏ„Î®ÏƒÎ·Ï‚", text_color=color_white, bgcolor=color_gray)
        table.cell(statsTable, 1, 13, str.tostring(avgCostBasis, format.mintick), text_color=color_white, bgcolor=color_gray)
